{"context":{},"error":"this.logger.logInfo is not a function","event":"error","level":"error","message":"AI operation failed","sessionId":"system_prompt_load","stack":"TypeError: this.logger.logInfo is not a function\n    at AIAgent.loadSystemPrompt (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:48:21)\n    at async AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:136:7)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:375:7)","timestamp":"2025-10-23T02:32:29.662Z"}
{"context":{},"error":"OpenAI connection failed: Invalid OpenAI API key. Please check your configuration.","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: Invalid OpenAI API key. Please check your configuration.\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:147:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:375:7)","timestamp":"2025-10-23T02:33:19.219Z"}
{"context":{},"error":"OpenAI connection failed: Invalid OpenAI API key. Please check your configuration.","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: Invalid OpenAI API key. Please check your configuration.\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:154:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (/Users/shamry/Projects/haier-decoder/tests/integration/ai-conversation.test.js:49:5)","timestamp":"2025-10-23T02:47:54.819Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:154:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:50:23.123Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:154:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:50:59.223Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:155:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:51:22.397Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:155:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:51:39.330Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:155:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:51:56.929Z"}
{"context":{},"error":"OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter","event":"error","level":"error","message":"AI operation failed","sessionId":"initialization","stack":"Error: OpenAI connection failed: OpenAI API error: 400 you must provide a model parameter\n    at AIAgent.initialize (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:155:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIIntegration.initialize (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:46:7)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:376:7)","timestamp":"2025-10-23T02:52:17.063Z"}
{"context":{"protocolKnowledge":{"isLoaded":true,"knowledge":{"commands":[{"category":"wash_programs","commandHex":"60 01","commandId":"wash-program-01","commandName":"Wash Program 1","description":"Standard wash program with normal cycle","examples":["ff ff 0e 40 00 00 00 00 00 60 00 01 01 00 00 00 b0 34 ad"],"parameters":["program_type"],"relatedCommands":["wash-program-02","wash-program-03","wash-program-04"]},{"category":"wash_programs","commandHex":"60 02","commandId":"wash-program-02","commandName":"Wash Program 2","description":"Quick wash program with shorter cycle","examples":["ff ff 0e 40 00 00 00 00 00 60 00 01 02 00 00 00 b1 70 ad"],"parameters":["program_type"],"relatedCommands":["wash-program-01","wash-program-03","wash-program-04"]},{"category":"wash_programs","commandHex":"60 03","commandId":"wash-program-03","commandName":"Wash Program 3","description":"Heavy duty wash program for heavily soiled items","examples":["ff ff 0e 40 00 00 00 00 00 60 00 01 03 00 00 00 b2 8c ac"],"parameters":["program_type"],"relatedCommands":["wash-program-01","wash-program-02","wash-program-04"]},{"category":"wash_programs","commandHex":"60 04","commandId":"wash-program-04","commandName":"Wash Program 4","description":"Delicate wash program for sensitive fabrics","examples":["ff ff 0e 40 00 00 00 00 00 60 00 01 04 00 00 00 b3 f8 ad"],"parameters":["program_type"],"relatedCommands":["wash-program-01","wash-program-02","wash-program-03"]},{"category":"control","commandHex":"01 5d 1f 00 01","commandId":"reset-standby","commandName":"Reset to Standby","description":"Return device to standby state","examples":["ff ff 0c 40 00 00 00 00 00 01 5d 1f 00 01 ca bb 9b"],"parameters":[],"relatedCommands":["init-command"]},{"category":"control","commandHex":"01 4d 01","commandId":"init-command","commandName":"Initialization Command","description":"Session initialization and handshake","examples":["ff ff 0a 40 00 00 00 00 00 01 4d 01 99 b3 b4"],"parameters":[],"relatedCommands":["reset-standby","ack-command"]},{"category":"control","commandHex":"05 4d 61","commandId":"ack-command","commandName":"Acknowledgment","description":"Standard acknowledgment response","examples":["ff ff 08 40 00 00 00 00 00 05 4d 61 80"],"parameters":[],"relatedCommands":["init-command","control-signal"]},{"category":"control","commandHex":"09 51 64","commandId":"control-signal","commandName":"Control Signal","description":"Control signal for device communication","examples":["ff ff 08 40 00 00 00 00 00 09 51 64 80"],"parameters":[],"relatedCommands":["ack-command"]}],"crcAlgorithms":[{"description":"3-byte CRC validation for protocol packets","name":"Standard CRC","testVectors":[{"data":"ff ff 0e 40 00 00 00 00 00 60 00 01 01 00 00 00","expectedCrc":"b0 34 ad"}]}],"packetStructure":{"crcLength":3,"description":"Standard Haier protocol packet structure","frameType":"40","lengthByte":"variable","preamble":"ff ff","sequenceLength":4},"statusResponses":[{"category":"status","description":"Device is ready and in standby mode","examples":["ff ff 43 40 00 00 00 00 00 6d 01 01 30 30 [additional_data] [crc]"],"statusHex":"6d 01 01 30 30","statusId":"ready-standby","statusName":"Ready/Standby"},{"category":"status","description":"Wash program is currently active","examples":["ff ff 43 40 00 00 00 00 00 6d 01 01 b0 31 [additional_data] [crc]"],"statusHex":"6d 01 [program] b0 31","statusId":"program-running","statusName":"Program Running"},{"category":"status","description":"Device is busy and cannot accept new commands","examples":["ff ff 43 40 00 00 00 00 00 6d 01 02 b0 31 [additional_data] [crc]"],"statusHex":"6d 01 02 b0 31","statusId":"device-busy","statusName":"Device Busy"},{"category":"status","description":"Device is resetting to standby mode","examples":["ff ff 43 40 00 00 00 00 00 6d 01 04 30 30 [additional_data] [crc]"],"statusHex":"6d 01 04 30 30","statusId":"reset-progress","statusName":"Reset in Progress"}]},"options":{"knowledgePath":"/Users/shamry/Projects/haier-decoder/src/ai/protocol-knowledge.json","testVectorsPath":"/Users/shamry/Projects/haier-decoder/tests/ai/protocol-test-vectors.json"},"testVectors":{"aiTestScenarios":[{"expectedResponse":{"confidence":0.9,"contains":["wash program","0x60","command"],"type":"explanation"},"name":"Protocol Query - Command Explanation","query":"What does command 0x60 do?"},{"context":{"packet":"ff ff 0e 40 00 00 00 00 00 60 00 01 01 00 00 00 b0 34 ae"},"expectedResponse":{"confidence":0.8,"contains":["CRC","validation","error"],"type":"troubleshooting"},"name":"Protocol Query - CRC Troubleshooting","query":"Why is this packet failing CRC validation?"},{"context":{"packets":["ff ff 0a 40 00 00 00 00 00 01 4d 01 99 b3 b4","ff ff 08 40 00 00 00 00 00 05 4d 61 80"]},"expectedResponse":{"confidence":0.9,"contains":["authentication","handshake","init"],"type":"explanation"},"name":"Protocol Query - Authentication Flow","query":"Explain this authentication flow"}],"statusTestVectors":[{"description":"Test vector for ready/standby status response","expectedCrc":"variable","expectedPacket":"ff ff 43 40 00 00 00 00 00 6d 01 01 30 30 [additional_data] [crc]","input":{"sequence":"00 00 00 00","status":"01 30 30"},"name":"Ready Status"},{"description":"Test vector for program running status","expectedCrc":"variable","expectedPacket":"ff ff 43 40 00 00 00 00 00 6d 01 01 b0 31 [additional_data] [crc]","input":{"program":"01","sequence":"00 00 00 00","status":"01 b0 31"},"name":"Program Running Status"},{"description":"Test vector for device busy status","expectedCrc":"variable","expectedPacket":"ff ff 43 40 00 00 00 00 00 6d 01 02 b0 31 [additional_data] [crc]","input":{"sequence":"00 00 00 00","status":"02 b0 31"},"name":"Device Busy Status"}],"testVectors":[{"description":"Test vector for wash program 1 command","expectedCrc":"b0 34 ad","expectedPacket":"ff ff 0e 40 00 00 00 00 00 60 00 01 01 00 00 00 b0 34 ad","input":{"command":"60 01","data":"01 00 00 00","sequence":"00 00 00 00"},"name":"Wash Program 1 Command"},{"description":"Test vector for wash program 2 command","expectedCrc":"b1 70 ad","expectedPacket":"ff ff 0e 40 00 00 00 00 00 60 00 01 02 00 00 00 b1 70 ad","input":{"command":"60 02","data":"02 00 00 00","sequence":"00 00 00 00"},"name":"Wash Program 2 Command"},{"description":"Test vector for reset to standby command","expectedCrc":"ca bb 9b","expectedPacket":"ff ff 0c 40 00 00 00 00 00 01 5d 1f 00 01 ca bb 9b","input":{"command":"01 5d 1f 00 01","data":"","sequence":"00 00 00 00"},"name":"Reset Command"},{"description":"Test vector for initialization command","expectedCrc":"99 b3 b4","expectedPacket":"ff ff 0a 40 00 00 00 00 00 01 4d 01 99 b3 b4","input":{"command":"01 4d 01","data":"","sequence":"00 00 00 00"},"name":"Init Command"},{"description":"Test vector for acknowledgment response","expectedCrc":"80","expectedPacket":"ff ff 08 40 00 00 00 00 00 05 4d 61 80","input":{"command":"05 4d 61","data":"","sequence":"00 00 00 00"},"name":"Ack Response"}]}},"queryType":"question"},"error":"Cannot read properties of undefined (reading 'find')","event":"error","level":"error","message":"AI operation failed","sessionId":"Response validation failed","stack":"TypeError: Cannot read properties of undefined (reading 'find')\n    at ResponseValidator.validateAgainstProtocolKnowledge (/Users/shamry/Projects/haier-decoder/src/ai/response-validator.js:218:50)\n    at ResponseValidator.validateProtocol (/Users/shamry/Projects/haier-decoder/src/ai/response-validator.js:207:18)\n    at ResponseValidator.validateResponse (/Users/shamry/Projects/haier-decoder/src/ai/response-validator.js:116:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async AIAgent.processQuery (/Users/shamry/Projects/haier-decoder/src/ai/agent.js:212:32)\n    at async AIIntegration.processQuery (/Users/shamry/Projects/haier-decoder/src/cli/ai-integration.js:78:22)\n    at async Command.<anonymous> (/Users/shamry/Projects/haier-decoder/src/index.js:380:22)","timestamp":"2025-10-23T02:53:50.221Z"}
